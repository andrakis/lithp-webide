<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

	<head>
		<meta content="en-us" http-equiv="Content-Language" />
		<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
		<title>This is the editor</title>
		<style type="text/css" media="screen">
		body {
			overflow: hidden;
			margin: 0;
		}

		#editor {
			margin: 0;
			position: absolute;
			top: 0;
			bottom: 0;
			left: 0;
			right: 0;
			height: 100%;
			width: 100%;
		}
		</style>

	</head>

	<body>

		<pre id="editor">% Sample: recurse
%
% Purpose: Demonstrate tail recursion via the recurse/* builtin.
%
%          Note that the stack depth remains constant when run
%          with the debug mode flag.
(
	(def fac-recursive #N :: (
		(def fac-r-inner #N,Acc :: (
			(if (== 0 N) (
				(Acc)
			) (else (
				(recurse (- N 1) (* N Acc))
			)))
		))
		(fac-r-inner N 1)
	))

	(print (fac-recursive 100))
)</pre>
		<script src="src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
		<script src="types.js" type="text/javascript"></script>
		<script src="frame-shared.js" type="text/javascript"></script>
		<script src="jquery-3.1.1.js" type="text/javascript"></script>
		<script src="base64.js" type="text/javascript"></script>
		<script type="text/javascript">
			var editor = ace.edit("editor");
			editor.setTheme("ace/theme/idle_fingers");
			editor.session.setMode("ace/mode/lithp");
			/*if(codeMatch) {
				// -1 moves cursor to start
				editor.setValue(Base64.decode(codeMatch[1]), -1);
			}
			function updatePermalink () {
				var code64 = Base64.encode(editor.getValue());
				codePermalink.href = "?code=" + code64;
			}*/
			window.onmessage = function(msg) {
				var data = msg.data;
				switch(data.type) {
					case msgGetEditorCode:
						window.parent.postMessage(MsgGotEditorCode(editor.getValue()), "*");
						break;
					case msgSetEditorCode:
						editor.setValue(data.code, -1);
						break;
					case msgStartUpdatePermalink:
						var link = Base64.encode(editor.getValue());
						window.parent.postMessage(MsgGotUpdatePermalink(link), "*");
					default:
						console.log("(editor) unknown message: " + data.type);
						break;
				}
			}
			$(function() {
				window.parent.postMessage(MsgFrameReady("editor"), "*");
			});
		</script>

	</body>

</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
	<meta content="en-us" http-equiv="Content-Language" />
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
	<title>Editor Palette</title>
	<script src="types.js" type="text/javascript"></script>
	<script src="jquery-3.1.1.js" type="text/javascript"></script>
	<script src="frame-shared.js" type="text/javascript"></script>
	<link rel="stylesheet" href="frame-palette/styles.css" />
</head>

<body>

<div id="optionsPanel" style="position:absolute;height:100%;width:260px">
  <a href="http://c9.io" title="Cloud9 IDE | Your code anywhere, anytime">
    <img id="c9-logo" src="frame-palette/ace-logo-1.png" style="width: 172px;margin: -9px 30px -12px 51px;">
  </a>
  <div style="position: absolute; overflow: hidden; top:100px; bottom:0">
  <div style="width: 120%; height:100%; overflow-y: scroll">

  <table id="controls">
    <tr>
      <td>
        <label for="doc">Document</label>
      </td><td>
        <select disabled id="doc" size="1">
        	<option>unnamed.lithp</option>
        </select>
      </td>
    </tr>
    <tr>
      <td >
        <label for="mode">Mode</label>
      </td><td>
        <select disabled id="mode" size="1">
        	<option>Lithp</option>
        </select>
      </td>
    </tr>
    <tr>
      <td>
        <label for="split">Split</label>
      </td><td>
        <select disabled id="split" size="1">
          <option value="none">None</option>
          <option value="below">Below</option>
          <option value="beside">Beside</option>
        </select>
      </td>
    </tr>
    <tr>
      <td >
        <label for="theme">Theme</label>
      </td><td>
        <select disabled id="theme" size="1">
        	<option>idle Fingers</option>
        </select>
      </td>
    </tr>
    <tr>
      <td>
        <label for="fontsize">Font Size</label>
      </td><td>
        <select disabled id="fontsize" size="1">
          <option value="10px">10px</option>
          <option value="11px">11px</option>
          <option value="12px" selected="selected">12px</option>
          <option value="13px">13px</option>
          <option value="14px">14px</option>
          <option value="16px">16px</option>
          <option value="18px">18px</option>
          <option value="20px">20px</option>
          <option value="24px">24px</option>
        </select>
      </td>
    </tr>
    <tr>
      <td>
        <label for="folding">Code Folding</label>
      </td><td>
        <select disabled id="folding" size="1">
          <option value="manual">manual</option>
          <option value="markbegin" selected="selected">mark begin</option>
          <option value="markbeginend">mark begin and end</option>
        </select>
      </td>
    </tr>
    <tr>
      <td >
        <label for="keybinding">Key Binding</label>
      </td><td>
        <select id="keybinding" size="1">
          <option value="">Ace</option>
          <option value="ace/keyboard/vim">Vim</option>
          <option value="ace/keyboard/emacs">Emacs</option>
        </select>
      </td>
    </tr>
    <tr>
      <td >
        <label for="soft_wrap">Soft Wrap</label>
      </td><td>
        <select disabled id="soft_wrap" size="1">
          <option value="off">Off</option>
          <option value="40">40 Chars</option>
          <option value="80">80 Chars</option>
          <option value="free">Free</option>
        </select>
      </td>
    </tr>

    <tr><td colspan="2">
    <table id="more-controls">
    <tr>
      <td>
        <label for="select_style">Full Line Selection</label>
      </td><td>
        <input disabled type="checkbox" name="select_style" id="select_style" checked>
      </td>
    </tr>
    <tr>
      <td>
        <label for="highlight_active">Highlight Active Line</label>
      </td><td>
        <input disabled type="checkbox" name="highlight_active" id="highlight_active" checked>
      </td>
    </tr>
    <tr>
      <td >
        <label for="show_hidden">Show Invisibles</label>
      </td><td>
        <input disabled type="checkbox" name="show_hidden" id="show_hidden" checked>
      </td>
    </tr>
    <tr>
      <td >
        <label for="display_indent_guides">Show Indent Guides</label>
      </td><td>
        <input disabled type="checkbox" name="display_indent_guides" id="display_indent_guides" checked>
      </td>
    </tr>
    <tr>
      <td >
        <label for="show_hscroll">Persistent HScroll</label>
      </td><td>
        <input disabled type="checkbox" name="show_hscroll" id="show_hscroll">
		<label for="show_hscroll">VScroll</label>
        <input disabled type="checkbox" name="show_vscroll" id="show_vscroll">
      </td>
    </tr>
    <tr>
      <td >
        <label for="animate_scroll">Animate scrolling</label>
      </td><td>
        <input disabled type="checkbox" name="animate_scroll" id="animate_scroll">
      </td>
    </tr>
    <tr>
      <td >
        <label for="show_gutter">Show Gutter</label>
      </td><td>
        <input disabled type="checkbox" id="show_gutter" checked>
      </td>
    </tr>
    <tr>
      <td >
        <label for="show_print_margin">Show Print Margin</label>
      </td><td>
        <input disabled type="checkbox" id="show_print_margin" checked>
      </td>
    </tr>
    <tr>
      <td >
        <label for="soft_tab">Use Soft Tab</label>
      </td><td>
        <input disabled type="checkbox" id="soft_tab" checked>
      </td>
    </tr>
    <tr>
      <td >
        <label for="highlight_selected_word">Highlight selected word</label>
      </td>
      <td>
        <input disabled type="checkbox" id="highlight_selected_word" checked>
      </td>
    </tr>
    <tr>
      <td >
        <label for="enable_behaviours">Enable Behaviours</label>
      </td>
      <td>
        <input disabled type="checkbox" id="enable_behaviours">
      </td>
    </tr>
    <tr>
      <td >
        <label for="fade_fold_widgets">Fade Fold Widgets</label>
      </td>
      <td>
        <input disabled type="checkbox" id="fade_fold_widgets">
      </td>
    </tr>
    <tr>
      <td >
        <label for="elastic_tabstops">Enable Elastic Tabstops</label>
      </td>
      <td>
        <input disabled type="checkbox" id="elastic_tabstops">
      </td>
    </tr>
    <tr>
      <td >
        <label for="isearch">Incremental Search</label>
      </td>
      <td>
        <input disabled type="checkbox" id="isearch">
      </td>
    </tr>
    <tr>
      <td >
        <label for="highlight_token">Show token info</label>
      </td>
      <td>
        <input disabled type="checkbox" id="highlight_token">
      </td>
    </tr>
    <tr>
      <td >
        <label for="read_only">Read-only</label>
      </td>
      <td>
        <input disabled type="checkbox" id="read_only">
      </td>
    </tr>
    <tr>
      <td >
        <label for="scrollPastEnd">Scroll Past End</label>
      </td>
      <td>
        <input disabled type="checkbox" id="scrollPastEnd" checked>
      </td>
    </tr>
    <tr>
      <td colspan="2">
        <input disabled type="button" value="Edit Snippets" onclick="env.editSnippets()">
      </td>
    </tr>
    <tr>
      <td colspan="2">
        <input disabled type="button" value="Add Textarea" onclick="this.parentNode.replaceChild(
          document.createElement('textarea'), this
        )">
      </td>
    </tr>
  </table>
  </td></tr>
  </table>
  
  <a href="http://ace.c9.io">
    <img id="ace-logo" src="frame-palette/ace-logo-2.png" style="width: 134px;margin: 46px 0px 4px 66px;">
  </a>
  </div>
  </div>
</div>

	<script src="lithp-pkg.js" type="text/javascript"></script>
	<script type="text/javascript">
		window.LithpPostMessage = function(message) {
			window.parent.postMessage(message, "*");
		};
		window.onmessage = function(msg) {
			var data = msg.data;
			switch(data.type) {
				case msgStartPaletteHandler:
					startPaletteHandler();
					break;
				default:
					console.log("(palette) Unknown message: " + data.type);
					break;
			}
		};
		jQuery.noConflict();
		jQuery(function() {
			window.LithpPostMessage(MsgFrameReady("palette"));
		});

		var instance = window.lithpInstance;
		var idePaletteCode = global._lithp.fileCache['webide/palette.ast'] || [ [ [ 'throw', 'filenotfound' ] ] ];
		var idePalette = Lithp.Parser(idePaletteCode, {finalize: true, ast: true});

		function startPaletteHandler () {
			console.log("Invoking palette onReady/onJQuery events");
			instance.setupDefinitions(idePalette, "webide");
			// Required on packaged Lithp
			instance.Define(idePalette, "__AST__", Lithp.Types.Atom("true"))
			instance.setupDefinitions(idePalette, "webide/palette");
			try {
				var timed = timeCall("Run code", () => instance.run(idePalette));
				console.log("Palette init run in " + timed[1] + "ms, idePalette: " + timed[0]);
			} catch (e) {
				console.log(e.stack);
			}
			if(instance.Defined(idePalette, "HTML_TOOLKIT") == Lithp.Types.Atom("true")) {
				try {
					instance.Invoke(idePalette, "onReady/*", [document, window]);
				} catch (e) {
					console.log(e.stack);
				}
			}
			if(instance.Defined(idePalette, "JQUERY_TOOLKIT") == Lithp.Types.Atom("true")) {
				if(window.jQuery) {
					console.log("Invoking jQuery behaviour");
					window.jQuery.noConflict();
					try {
						instance.Invoke(idePalette, "onJQuery/1", [window.jQuery])
					} catch (e) {
						console.log(e.stack);
					}
				}
			}
		}
	</script>
</body>

</html>
